---
title: DL_Note
createTime: 2025/12/27 14:44:18
permalink: /notes/Lee_DL/t9rbwk0z/
---
# DLä¸€äº›ç¬”è®°




## å¦‚ä½•ä¼˜åŒ–ä»£ç 

![image-20251206152115946](https://cdn.jsdelivr.net/gh/salt235/tuchuang@main/macImg/image-20251206152115946.png)

### 1. è¯Šæ–­æ­¥éª¤ï¼šæ£€æŸ¥è®­ç»ƒæ•°æ®ä¸Šçš„æŸå¤± ($L_{\text{train}}$)

é¦–å…ˆæ£€æŸ¥æ¨¡å‹åœ¨**è®­ç»ƒé›†**ä¸Šçš„è¡¨ç°ã€‚

| **Ltrain**       | **é—®é¢˜æ–¹å‘**                                           | **è¯Šæ–­ç»“æœ**                                 | **è§£å†³æ–¹æ¡ˆ**       |
| ---------------- | ------------------------------------------------------ | -------------------------------------------- | ------------------ |
| **å¾ˆå¤§ (large)** | **1. æ¨¡å‹åå·® (model bias) / æ¬ æ‹Ÿåˆ (Underfitting)**   | æ¨¡å‹è¿‡äºç®€å•ï¼Œè¡¨è¾¾èƒ½åŠ›ä¸è¶³ã€‚                 | **ä½¿æ¨¡å‹æ›´å¤æ‚**   |
| **å¾ˆå¤§ (large)** | **2. ä¼˜åŒ–é—®é¢˜ (optimization)(æ¯”å¦‚è¯´æ˜¯æ¢¯åº¦ä¸‹é™ä¸ç®¡ç”¨)** | æ¨¡å‹ç†è®ºä¸Šèƒ½æ‹Ÿåˆï¼Œä½†ä¼˜åŒ–å™¨æœªèƒ½æ‰¾åˆ°å¥½çš„æƒé‡ã€‚ | **è°ƒæ•´ä¼˜åŒ–å™¨å‚æ•°** |
| **å¾ˆå° (small)** | **â†’ è¿›å…¥ä¸‹ä¸€æ­¥ï¼šæ£€æŸ¥æµ‹è¯•æŸå¤±ã€‚**                       | æ¨¡å‹å·²å­¦ä¼šè®­ç»ƒé›†æ•°æ®ã€‚                       | -                  |

### 2. è¯Šæ–­æ­¥éª¤ï¼šæ£€æŸ¥æµ‹è¯•æ•°æ®ä¸Šçš„æŸå¤± ($L_{\text{test}}$)

å¦‚æœ $L_{\text{train}}$ å¾ˆå°ï¼Œæ¥ç€æ£€æŸ¥æ¨¡å‹åœ¨**æµ‹è¯•é›†**ä¸Šçš„æ³›åŒ–èƒ½åŠ›ã€‚

| **Ltest**        | **é—®é¢˜è¯Šæ–­**                | **è§£å†³æ–¹æ¡ˆ**                         |
| ---------------- | --------------------------- | ------------------------------------ |
| **å¾ˆå¤§ (large)** | **1. è¿‡æ‹Ÿåˆ (overfitting)** | æ¨¡å‹è¿‡åº¦å­¦ä¹ è®­ç»ƒé›†ç»†èŠ‚å’Œå™ªå£°ã€‚       |
| **å¾ˆå¤§ (large)** | **2. é”™é… (mismatch)**      | è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„**æ•°æ®åˆ†å¸ƒä¸ä¸€è‡´**ã€‚ |
| **å¾ˆå° (small)** | **æ¨¡å‹è¡¨ç°è‰¯å¥½** ğŸ˜Š          | -                                    |

### æ€»ç»“

- **æ¬ æ‹Ÿåˆ** (é«˜åå·®) çš„è§£å†³æ–¹æ¡ˆæ˜¯**ä½¿æ¨¡å‹å¤æ‚**ã€‚

- **è¿‡æ‹Ÿåˆ** (é«˜æ–¹å·®) çš„è§£å†³æ–¹æ¡ˆæ˜¯**ä½¿æ¨¡å‹ç®€å•**ã€‚

- åœ¨ä¸¤è€…ä¹‹é—´å¯»æ‰¾å¹³è¡¡æ˜¯æ·±åº¦å­¦ä¹ è°ƒå‚çš„å…³é”®ã€‚

> æ¨¡å‹çš„å¼¹æ€§ï¼š
>
> ä¸€ä¸ª**æœ‰å¼¹æ€§**çš„æ¨¡å‹ä¸ä¼šå› ä¸ºä¸€ç‚¹ç‚¹å™ªå£°å°±å´©æºƒæˆ–åšå‡ºè’è°¬çš„é¢„æµ‹ï¼Œå®ƒèƒ½**æŒç»­ç¨³å®š**åœ°åœ¨å„ç§å¤æ‚å’Œå˜åŒ–çš„ç¯å¢ƒä¸­æä¾›æœ‰ç”¨çš„ç»“æœã€‚

## å¦‚ä½•å¤„ç†è¿‡æ‹Ÿåˆ

### 1.æ•°æ®å±‚é¢

![image-20251206153805048](https://cdn.jsdelivr.net/gh/salt235/tuchuang@main/macImg/image-20251206153805048.png)

- **å¢åŠ è®­ç»ƒæ•°æ® (More Training Data):** è¿™æ˜¯æœ€å¯é çš„æ–¹æ³•ï¼Œç›´æ¥æä¾›æ›´å¤šã€æ›´å…·æ™®éæ€§çš„æ ·æœ¬ï¼Œè¿«ä½¿æ¨¡å‹å­¦ä¹ æ›´æŠ½è±¡çš„ç‰¹å¾ã€‚

- **æ•°æ®å¢å¼º (Data Augmentation):** é€šè¿‡å¯¹ç°æœ‰æ•°æ®è¿›è¡Œç³»ç»Ÿæ€§å˜æ¢ï¼ˆå¦‚å›¾åƒçš„æ—‹è½¬ã€è£å‰ªã€è‰²å½©å˜æ¢ç­‰ï¼‰ï¼Œäººå·¥æ‰©å±•è®­ç»ƒé›†çš„è§„æ¨¡å’Œå¤šæ ·æ€§ã€‚

### 2.æ¨¡å‹å±‚é¢

![image-20251206154155277](https://cdn.jsdelivr.net/gh/salt235/tuchuang@main/macImg/image-20251206154155277.png)

## KæŠ˜äº¤å‰éªŒè¯

K æŠ˜äº¤å‰éªŒè¯çš„åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š

### 1. åˆ’åˆ†æ•°æ®é›†

å°†æ•´ä¸ªå¯ç”¨çš„æ•°æ®é›†ï¼ˆé€šå¸¸æ˜¯è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„æ€»å’Œï¼Œä¸åŒ…æ‹¬æµ‹è¯•é›†ï¼‰**éšæœº**åœ°åˆ†æˆ $K$ ä¸ªå¤§å°ç›¸ç­‰çš„å­é›†ï¼ˆæˆ–ç§°â€œæŠ˜â€/â€œFoldâ€ï¼‰ã€‚

### 2. è¿›è¡Œ K æ¬¡å¾ªç¯è®­ç»ƒ

è¿›è¡Œ $K$ æ¬¡ç‹¬ç«‹çš„æ¨¡å‹è®­ç»ƒå’Œè¯„ä¼°å¾ªç¯ï¼š

- **éªŒè¯é›† (Validation Set):** åœ¨ç¬¬ $i$ æ¬¡å¾ªç¯ä¸­ï¼Œå°†ç¬¬ $i$ ä¸ªå­é›†ä½œä¸º**éªŒè¯é›†**ã€‚
- **è®­ç»ƒé›† (Training Set):** å°†å‰©ä¸‹çš„ $K-1$ ä¸ªå­é›†**åˆå¹¶**èµ·æ¥ä½œä¸º**è®­ç»ƒé›†**ï¼Œç”¨äºè®­ç»ƒæ¨¡å‹ã€‚

### 3. æ€§èƒ½å¹³å‡

æ¯æ¬¡å¾ªç¯éƒ½ä¼šå¾—åˆ°ä¸€ä¸ªæ€§èƒ½æŒ‡æ ‡ï¼ˆä¾‹å¦‚å‡†ç¡®ç‡ã€æŸå¤±å€¼ç­‰ï¼‰ã€‚æœ€ç»ˆï¼Œæ¨¡å‹åœ¨äº¤å‰éªŒè¯ä¸‹çš„æ€§èƒ½å°±æ˜¯è¿™ **$K$ æ¬¡ç»“æœçš„å¹³å‡å€¼**ã€‚

### 4.ä¼˜åŠ¿

- **æ›´å¯é çš„æ€§èƒ½è¯„ä¼°ï¼š** ç”±äºæ¯ä¸ªæ•°æ®ç‚¹éƒ½æ°å¥½è¢«ç”¨äºéªŒè¯ä¸€æ¬¡ï¼Œå¹¶ä¸”è¢«ç”¨äºè®­ç»ƒ $K-1$ æ¬¡ï¼Œå› æ­¤å®ƒå¯ä»¥æ›´å……åˆ†åœ°åˆ©ç”¨æ•°æ®ï¼Œå‡å°‘äº†ç”±äºéšæœºåˆ’åˆ†å¯¼è‡´çš„**è¯„ä¼°åå·®**ã€‚

- **å‡å°‘è¿‡æ‹Ÿåˆé£é™©çš„ä¼°è®¡ï¼š** å®ƒå¯ä»¥æ›´å¥½åœ°ä¼°è®¡æ¨¡å‹åœ¨é¢å¯¹æ–°æ•°æ®æ—¶çš„**æ³›åŒ–èƒ½åŠ›**ã€‚

- **æ•°æ®åˆ©ç”¨ç‡é«˜ï¼š** åœ¨æ•°æ®é›†è§„æ¨¡è¾ƒå°æ—¶å°¤å…¶æœ‰ç”¨ï¼Œå®ƒèƒ½ç¡®ä¿æ‰€æœ‰æ•°æ®ç‚¹éƒ½è¢«ç”¨äºéªŒè¯ã€‚

## æ¨¡å‹ä¼˜åŒ–å¤±è´¥åŸå› 

![image-20251206160740918](https://cdn.jsdelivr.net/gh/salt235/tuchuang@main/macImg/image-20251206160740918.png)

å½“æ¢¯åº¦ ($\nabla J(\theta)$) æ¥è¿‘æˆ–ç­‰äºé›¶æ—¶ï¼Œä¼˜åŒ–å™¨ä¼šé‡åˆ°ä»¥ä¸‹ä¸¤ç§ä¸»è¦ç±»å‹çš„**ä¸´ç•Œç‚¹(critical point)**ï¼š

- **å±€éƒ¨æœ€å°å€¼ (local minima):**
  - **æè¿°:** æŸå¤±æ›²é¢ä¸­çš„ä¸€ä¸ªå‡¹é™·ç‚¹ï¼Œè¯¥ç‚¹çš„æŸå¤±å€¼å¤§äºå…¨å±€æœ€å°å€¼ã€‚
  - **å½±å“:** ç®—æ³•åˆ°è¾¾æ­¤ç‚¹åï¼Œæ¢¯åº¦ä¸ºé›¶ï¼Œå‚æ•°åœæ­¢æ›´æ–°ï¼Œæ¨¡å‹è¢«å›°åœ¨ä¸€ä¸ªæ¬¡ä¼˜è§£ã€‚
- **éç‚¹ (saddle point):**
  - **æè¿°:** æŸå¤±æ›²é¢ä¸­çš„ä¸€ä¸ªç‚¹ï¼Œå…¶æ¢¯åº¦ä¹Ÿä¸ºé›¶ï¼Œä½†åœ¨æŸäº›ç»´åº¦ä¸Šæ˜¯å‘ä¸‹å‡¸çš„ï¼Œè€Œåœ¨å…¶ä»–ç»´åº¦ä¸Šæ˜¯å‘ä¸Šå‡¹çš„ï¼ˆå½¢çŠ¶åƒé©¬éï¼‰ã€‚
  - **å½±å“:** åœ¨é«˜ç»´ç©ºé—´ä¸­éç‚¹éå¸¸å¸¸è§ã€‚ç®—æ³•å¯èƒ½ä¼šè¢«å›°åœ¨æ­¤ç‚¹ï¼Œæˆ–è€…å¦‚æœä½¿ç”¨å°æ‰¹é‡ SGD ç­‰å¸¦æœ‰éšæœºæ€§çš„æ–¹æ³•ï¼Œå¯èƒ½ä¼šç¼“æ…¢åœ°é€ƒç¦»ã€‚

### å¦‚ä½•åˆ†è¾¨

![image-20251206162222264](https://cdn.jsdelivr.net/gh/salt235/tuchuang@main/macImg/image-20251206162222264.png)

æ³°å‹’çº§æ•°è¿‘ä¼¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šåœ¨æŸä¸ªç‚¹aé™„è¿‘ï¼Œå¯ä»¥ç”¨ä¸€ä¸ª**å¤šé¡¹å¼**æ¥é€¼è¿‘ä¸€ä¸ªå¤æ‚çš„å‡½æ•°ã€‚

æ¯”å¦‚ï¼š$$f(x) = f(a) + f'(a)(x-a) + \frac{f''(a)}{2!}(x-a)^2 $$ï¼Œxæ˜¯aé™„è¿‘çš„ç‚¹ã€‚

å½“æ¢¯åº¦ä¸º0ï¼Œ$$ f'(a)(x-a)$$ä¸º0ï¼Œå°±å¯ä»¥å»çœ‹$$f(x) = f(a) + \frac{f''(a)}{2!}(x-a)^2 $$ï¼Œå¦‚ä¸Šå›¾ã€‚

## Batchå’ŒMomentum

### 1. Small Batchå’ŒLarge Batch

- **Batch å¤§ â†’ æ¢¯åº¦æ›´ç¨³å®š smootherï¼Œæ”¶æ•›ç¨³å®šï¼ˆä¸ä¹±è·³ï¼‰**

- **Batch å° â†’ æ¢¯åº¦å™ªå£°å¤§ï¼Œè®­ç»ƒä¸ç¨³å®šï¼Œä½†æ›´å®¹æ˜“è·³å‡ºå±€éƒ¨æœ€ä¼˜**

> è¶…å¤§ batch ä¼šè®©æ¢¯åº¦å¤ªå‡†ç¡®ã€å¤ªç¨³å®šï¼Œå¤±å»äº†éšæœºæ‰°åŠ¨ã€‚æ¨¡å‹å®¹æ˜“é™·å…¥ sharp minimaã€æ³›åŒ–èƒ½åŠ›å˜å·®ï¼Œè€Œä¸”æ›´æ–°é¢‘ç‡æ›´ä½ï¼Œå­¦ä¹ ç‡è°ƒæ•´å›°éš¾ï¼Œå› æ­¤ä¼˜åŒ–æ•ˆæœåè€Œä¸å¥½ã€‚

> å° batch ä¼šå¼•å…¥æ¢¯åº¦å™ªå£°ï¼Œè¿™ç§å™ªå£°æ˜¯ä¸€ç§â€œéšå¼æ­£åˆ™åŒ–â€ï¼Œå¸®åŠ©æ¨¡å‹æ‰¾åˆ°å¯¹æµ‹è¯•é›†æ›´å‹å¥½çš„å¹³å¦è§£ï¼ˆflat minimaï¼‰ï¼Œå› æ­¤æ³›åŒ–æ›´å¥½ã€‚

![image-20251206185253805](https://cdn.jsdelivr.net/gh/salt235/tuchuang@main/macImg/image-20251206185253805.png)

### 2. Momentum

> Momentum = æ¢¯åº¦ä¸‹é™ + â€œæƒ¯æ€§â€

![image-20251206185741458](https://cdn.jsdelivr.net/gh/salt235/tuchuang@main/macImg/image-20251206185741458.png)

æŠŠè¿‡å»çš„æ–¹å‘ä¹Ÿè€ƒè™‘è¿›å»ï¼Œè®©æ›´æ–°æ›´æœ‰æƒ¯æ€§ã€æ›´å¹³æ»‘ã€‚

## å®¢åˆ¶åŒ–çš„LR

> ä¸€å¼€å§‹å¤§èƒ†è¯•ã€åæœŸè°¨æ…èµ°
>
> å­¦ä¹ ç‡å¤§ â†’ å­¦å¾—å¿«ï¼Œä½†ä¸ç¨³å®š
>
> å­¦ä¹ ç‡å° â†’ ç¨³å®šä½†æ…¢

![image-20251206191316463](https://cdn.jsdelivr.net/gh/salt235/tuchuang@main/macImg/image-20251206191316463.png)

![](https://cdn.jsdelivr.net/gh/salt235/tuchuang@main/macImg/image-20251206191949972.png)

### 1. è‡ªåŠ¨è°ƒèŠ‚å­¦ä¹ ç‡(Root Mean Square)

- RMSProp

  $g_i^t$ï¼šå½“å‰æ¢¯åº¦

  $\sigma_i^t$ï¼šæœ€è¿‘ä¸€æ®µæ—¶é—´æ¢¯åº¦èƒ½é‡çš„â€œRMS å€¼â€

  $\alpha$ï¼šè¡°å‡ç³»æ•°ï¼Œä¸€èˆ¬ 0.9

- Adam = Momentum + RMSProp

### 2. å­¦ä¹ ç‡è°ƒåº¦(Learning Rate Scheduling)

![image-20251206193250018](https://cdn.jsdelivr.net/gh/salt235/tuchuang@main/macImg/image-20251206193250018.png)

- Learning Rate Decay

  æ¯éš”å›ºå®š epochï¼ŒæŠŠ LR é™ä½ã€‚

  âœ” éå¸¸å¹³æ»‘

- Warm up

  è®­ç»ƒä¸€å¼€å§‹ä¸è¦çªç„¶ç”¨å¤§ LRï¼Œå…ˆæ…¢æ…¢å‡ä¸Šå»ã€‚

  âœ” Transformerã€ä¸­å¤§å‹æ¨¡å‹æ ‡é…
  âœ” é˜²æ­¢è®­ç»ƒåˆæœŸ loss çˆ†ç‚¸

![image-20251206193702587](https://cdn.jsdelivr.net/gh/salt235/tuchuang@main/macImg/image-20251206193702587.png)

## åˆ†ç±»(Classification)

![image-20251206194210996](https://cdn.jsdelivr.net/gh/salt235/tuchuang@main/macImg/image-20251206194210996.png)

### 1. Softmax

softmaxæ˜¯æ·±åº¦å­¦ä¹ é‡Œ **æŠŠä¸€ç»„æ•°å˜æˆâ€œæ¦‚ç‡åˆ†å¸ƒâ€** çš„å‡½æ•°ã€‚

å®ƒèƒ½æŠŠä»»æ„å®æ•°å‘é‡è½¬æ¢æˆï¼š

- æ‰€æœ‰å€¼éƒ½åœ¨ 0 åˆ° 1 ä¹‹é—´
- æ‰€æœ‰å€¼åŠ èµ·æ¥ = 1
- è¶Šå¤§çš„å€¼å˜æˆè¶Šå¤§çš„æ¦‚ç‡

$\text{softmax}(z_i) = \frac{e^{z_i}}{\sum_{j=1}^{n} e^{z_j}}$

### 2. åˆ†ç±»é—®é¢˜çš„Loss

- MSEï¼ˆå‡æ–¹è¯¯å·®ï¼‰
  $$ \text{MSE} = \frac{1}{n} \sum_{i=1}^{n} (y_i' - \hat{y}_i)^2Â $$

  å½“ sigmoid è¾“å‡ºæ¥è¿‘ 0 æˆ– 1 æ—¶ï¼ŒMSE çš„æ¢¯åº¦æå°ï¼Œåœ¨åˆ†ç±»ä»»åŠ¡ä¸­éå¸¸å·®ï¼
  
  å›å½’ç”¨ MSEï¼Œå› ä¸ºå®ƒç›´æ¥è¡¡é‡æ•°å€¼å·®è·ã€‚
  
- Cross-Entropyï¼ˆäº¤å‰ç†µï¼‰
  $$ \text{CE} = - \sum_{i=1}^{C} \hat{y}_i \ln(y_i') $$
  
  åˆ†ç±»ç”¨ CEï¼Œå› ä¸ºå®ƒå¯¹æ¦‚ç‡æ•æ„Ÿã€æ¢¯åº¦ç¨³å®šã€è®­ç»ƒå¿«ï¼›
